{
  "swagger": "2.0",
  "info": {
    "title": "Users, Favorites, Activities & Reviews API",
    "description": "API with GitHub OAuth authentication and auto-assigned userId",
    "version": "1.0.0"
  },

  "host": "project2cse341.onrender.com",
  "basePath": "/",
  "schemes": ["https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],

  "securityDefinitions": {
    "github_oauth": {
      "type": "oauth2",
      "flow": "implicit",
      "authorizationUrl": "https://project2cse341.onrender.com/auth/github",
      "scopes": {
        "user:email": "Access user identity"
      }
    }
  },

  "paths": {
    "/user": {
      "get": {
        "tags": ["User"],
        "summary": "Get all users",
        "responses": {
          "200": {
            "description": "Users retrieved",
            "schema": {
              "type": "array",
              "items": { "$ref": "#/definitions/User" }
            }
          }
        }
      },
      "post": {
        "tags": ["User"],
        "summary": "Create new user (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          {
            "in": "body",
            "name": "User",
            "schema": { "$ref": "#/definitions/UserInput" }
          }
        ],
        "responses": {
          "201": { "description": "User created" },
          "422": { "description": "Validation failed" }
        }
      }
    },

    "/user/{id}": {
      "get": {
        "tags": ["User"],
        "summary": "Get user by ID",
        "parameters": [
          { "in": "path", "name": "id", "type": "string", "required": true }
        ],
        "responses": {
          "200": { "description": "User found", "schema": { "$ref": "#/definitions/User" } },
          "404": { "description": "User not found" }
        }
      },
      "put": {
        "tags": ["User"],
        "summary": "Update user (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "type": "string", "required": true },
          { "in": "body", "name": "User", "schema": { "$ref": "#/definitions/UserInput" } }
        ],
        "responses": { "200": { "description": "User updated" } }
      },
      "delete": {
        "tags": ["User"],
        "summary": "Delete user (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "type": "string", "required": true }
        ],
        "responses": { "200": { "description": "User deleted" } }
      }
    },

    "/favorites": {
      "get": {
        "tags": ["Favorites"],
        "summary": "Get all favorites",
        "responses": {
          "200": {
            "description": "Favorites retrieved",
            "schema": { "type": "array", "items": { "$ref": "#/definitions/Favorite" } }
          }
        }
      },
      "post": {
        "tags": ["Favorites"],
        "summary": "Create favorite (protected, userId auto-assigned)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "body", "name": "Favorite", "schema": { "$ref": "#/definitions/FavoriteInput" } }
        ],
        "responses": {
          "201": { "description": "Favorite created" },
          "422": { "description": "Validation failed" }
        }
      }
    },

    "/favorites/{id}": {
      "get": {
        "tags": ["Favorites"],
        "summary": "Get favorite by ID",
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" }
        ],
        "responses": {
          "200": { "description": "Favorite found", "schema": { "$ref": "#/definitions/Favorite" } },
          "404": { "description": "Not found" }
        }
      },
      "put": {
        "tags": ["Favorites"],
        "summary": "Update favorite (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" },
          { "in": "body", "name": "Favorite", "schema": { "$ref": "#/definitions/FavoriteInput" } }
        ],
        "responses": { "200": { "description": "Favorite updated" } }
      },
      "delete": {
        "tags": ["Favorites"],
        "summary": "Delete favorite (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" }
        ],
        "responses": { "200": { "description": "Favorite deleted" } }
      }
    },

    "/activities": {
      "get": {
        "tags": ["Activities"],
        "summary": "Get all activities",
        "responses": {
          "200": {
            "description": "Activities retrieved",
            "schema": { "type": "array", "items": { "$ref": "#/definitions/Activity" } }
          }
        }
      },
      "post": {
        "tags": ["Activities"],
        "summary": "Create activity (protected, userId auto-assigned)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "body", "name": "Activity", "schema": { "$ref": "#/definitions/ActivityInput" } }
        ],
        "responses": {
          "201": { "description": "Activity created" },
          "422": { "description": "Validation failed" }
        }
      }
    },

    "/activities/{id}": {
      "get": {
        "tags": ["Activities"],
        "summary": "Get activity by ID",
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" }
        ],
        "responses": {
          "200": { "description": "Activity found", "schema": { "$ref": "#/definitions/Activity" } },
          "404": { "description": "Not found" }
        }
      },
      "put": {
        "tags": ["Activities"],
        "summary": "Update activity (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "type": "string", "required": true },
          { "in": "body", "name": "Activity", "schema": { "$ref": "#/definitions/ActivityInput" } }
        ],
        "responses": { "200": { "description": "Activity updated" } }
      },
      "delete": {
        "tags": ["Activities"],
        "summary": "Delete activity (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "type": "string", "required": true }
        ],
        "responses": { "200": { "description": "Activity deleted" } }
      }
    },

    "/reviews": {
      "get": {
        "tags": ["Reviews"],
        "summary": "Get all reviews",
        "responses": {
          "200": {
            "description": "Reviews retrieved",
            "schema": { "type": "array", "items": { "$ref": "#/definitions/Review" } }
          }
        }
      },
      "post": {
        "tags": ["Reviews"],
        "summary": "Create review (protected, userId auto-assigned)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "body", "name": "Review", "schema": { "$ref": "#/definitions/ReviewInput" } }
        ],
        "responses": {
          "201": { "description": "Review created" },
          "422": { "description": "Validation failed" }
        }
      }
    },

    "/reviews/{id}": {
      "get": {
        "tags": ["Reviews"],
        "summary": "Get review by ID",
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" }
        ],
        "responses": {
          "200": { "description": "Review found", "schema": { "$ref": "#/definitions/Review" } },
          "404": { "description": "Not found" }
        }
      },
      "put": {
        "tags": ["Reviews"],
        "summary": "Update review (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" },
          { "in": "body", "name": "Review", "schema": { "$ref": "#/definitions/ReviewInput" } }
        ],
        "responses": { "200": { "description": "Review updated" } }
      },
      "delete": {
        "tags": ["Reviews"],
        "summary": "Delete review (protected)",
        "security": [{ "github_oauth": ["user:email"] }],
        "parameters": [
          { "in": "path", "name": "id", "required": true, "type": "string" }
        ],
        "responses": { "200": { "description": "Review deleted" } }
      }
    },

    "/auth/github": {
      "get": {
        "tags": ["Auth"],
        "summary": "Redirect to GitHub OAuth",
        "responses": { "302": { "description": "Redirecting" } }
      }
    },

    "/auth/github/callback": {
      "get": {
        "tags": ["Auth"],
        "summary": "OAuth callback",
        "responses": {
          "200": { "description": "Authenticated" },
          "401": { "description": "Auth failed" }
        }
      }
    },

    "/logout": {
      "get": {
        "tags": ["Auth"],
        "summary": "Logout",
        "responses": { "200": { "description": "Logged out" } }
      }
    }
  },

  "definitions": {
    "User": {
      "type": "object",
      "properties": {
        "_id": { "type": "string" },
        "username": { "type": "string" },
        "firstName": { "type": "string" },
        "lastName": { "type": "string" },
        "email": { "type": "string" },
        "age": { "type": "number" }
      }
    },

    "UserInput": {
      "type": "object",
      "required": ["firstName", "lastName", "email"],
      "properties": {
        "username": { "type": "string" },
        "firstName": { "type": "string" },
        "lastName": { "type": "string" },
        "email": { "type": "string" },
        "age": { "type": "number" }
      }
    },

    "Favorite": {
      "type": "object",
      "properties": {
        "_id": { "type": "string" },
        "userId": { "type": "string" },
        "firstName": { "type": "string" },
        "lastName": { "type": "string" },
        "favoriteFood": { "type": "string" },
        "favoriteColor": { "type": "string" },
        "favoriteSong": { "type": "string" },
        "favoriteMovie": { "type": "string" },
        "favoriteHobby": { "type": "string" },
        "birthday": { "type": "string" }
      }
    },

    "FavoriteInput": {
      "type": "object",
      "required": [
        "firstName",
        "lastName",
        "favoriteFood",
        "favoriteSong",
        "favoriteMovie",
        "favoriteHobby"
      ],
      "properties": {
        "firstName": { "type": "string" },
        "lastName": { "type": "string" },
        "favoriteFood": { "type": "string" },
        "favoriteColor": { "type": "string" },
        "favoriteSong": { "type": "string" },
        "favoriteMovie": { "type": "string" },
        "favoriteHobby": { "type": "string" },
        "birthday": { "type": "string" }
      }
    },

    "Activity": {
      "type": "object",
      "properties": {
        "_id": { "type": "string" },
        "userId": { "type": "string" },
        "eventName": { "type": "string" },
        "eventDate": { "type": "string" },
        "location": { "type": "string" },
        "description": { "type": "string" }
      }
    },

    "ActivityInput": {
      "type": "object",
      "required": ["eventName", "eventDate", "location"],
      "properties": {
        "eventName": { "type": "string" },
        "eventDate": { "type": "string" },
        "location": { "type": "string" },
        "description": { "type": "string" }
      }
    },

    "Review": {
      "type": "object",
      "properties": {
        "_id": { "type": "string" },
        "userId": { "type": "string" },
        "itemType": { "type": "string" },
        "itemName": { "type": "string" },
        "rating": { "type": "integer" },
        "comment": { "type": "string" }
      }
    },

    "ReviewInput": {
      "type": "object",
      "required": ["itemType", "itemName", "rating"],
      "properties": {
        "itemType": {
          "type": "string",
          "enum": ["movie", "song", "book", "game", "show"]
        },
        "itemName": { "type": "string" },
        "rating": { "type": "integer" },
        "comment": { "type": "string" }
      }
    }
  }
}
